{"ast":null,"code":"import axios from 'axios';\n//import { ref } from 'vue';\nexport default {\n  data() {\n    return {\n      data: [],\n      type: [],\n      fk_type: '',\n      serial_number: '',\n      text: ''\n    };\n  },\n  methods: {\n    onChangeSelect: function (e) {\n      var fk_id = e.target.value;\n      console.log('id = ', fk_id);\n      if (fk_id == '1') {\n        var regex = new RegExp(/[0-9A-Z]{2}[A-Z]{5}[A-Z0-9]{1}[A-Z]{2}/);\n      } else if (fk_id == '2') {\n        regex = new RegExp(/[0-9]{1}[A-Z0-9]{2}[A-Z]{2}[0-9A-Z]{1}[-,_,@]{1}[0-9A-Z]{1}[a-z]{2}/);\n      } else if (fk_id == '3') {\n        regex = new RegExp(/[0-9]{1}[A-Z]{4}[0-9A-Z]{1}[-,_,@]{1}[0-9A-Z]{3}/);\n      }\n      console.log('regex = ', regex);\n    },\n    async getData() {\n      try {\n        const response = await axios.get('http://127.0.0.1:9000/equipment/');\n        this.data = response.data;\n      } catch (error) {\n        // log the error\n        console.log(error);\n      }\n    },\n    async getType() {\n      try {\n        const response = await axios.get('http://127.0.0.1:9000/equipment-type/');\n        this.type = response.data;\n      } catch (error) {\n        // log the error\n        console.log(error);\n      }\n    },\n    async submitForm() {\n      var ser = document.getElementById('serial_number').value;\n      console.log('ser_num = ', ser);\n      console.log('this.regex = ', this.regex);\n      if (this.regex.test(ser) == true) {\n        try {\n          // Send a POST request to the API\n          await axios.post('http://localhost:9000/equipment/', {\n            fk_type: this.fk_type,\n            serial_number: this.serial_number,\n            text: this.text,\n            completed: false\n          });\n          console.log('this.fk_type = ', this.fk_type);\n          //this.data.push(response.data);\n          this.getData();\n          this.fk_type = '';\n          this.serial_number = '';\n          this.text = '';\n        } catch (error) {\n          // Log the error\n          console.log(error);\n        }\n      } else {\n        document.getElementById('serial_number').after('Ошибка введения серийного номера для данного типа оборудования');\n        return false;\n      }\n    },\n    async deleteEquipment(item) {\n      let confirmation = confirm(\"Вы действительно хотите удалить оборудование?\");\n      if (confirmation) {\n        try {\n          // Send a request to delete the item\n          await axios.delete(`http://localhost:9000/equipment/${item.id}`);\n          // Refresh the equipment list\n          this.getData();\n        } catch (error) {\n          console.log(error);\n        }\n      }\n    },\n    async toggleEquipment(item) {\n      try {\n        // Send a request to API to update the equipment\n        const response = await axios.put(`http://localhost:9000/equipment/${item.id}/`, {\n          //completed: false,\n          fk_type: item.fk_type,\n          serial_number: item.serial_number,\n          text: item.text\n        });\n        console.log('response.data = ', response.data);\n      } catch (error) {\n        // Log any error\n        console.log(error);\n      }\n    }\n  },\n  created() {\n    this.getData();\n    this.getType();\n  }\n};","map":{"version":3,"names":["axios","data","type","fk_type","serial_number","text","methods","onChangeSelect","e","fk_id","target","value","console","log","regex","RegExp","getData","response","get","error","getType","submitForm","ser","document","getElementById","test","post","completed","after","deleteEquipment","item","confirmation","confirm","delete","id","toggleEquipment","put","created"],"sources":["/home/pavel/Документы/NEW_DJUNGO_PROJECTS/test_api/frontend/django_client/src/components/EquipmentDrf.vue"],"sourcesContent":["<template>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css\" rel=\"stylesheet\"/>\n    <div class=\"equipment_container\">\n        <div class=\"add_equipment\">\n            <h2>Добавить оборудование</h2>\n            <form v-on:submit.prevent=\"submitForm\" class=\"col-4 mx-auto\">\n                <div class=\"form-group\">\n                    <label for=\"type\">Тип оборудования</label>\n                    <!--input type=\"text\" class=\"form-control\" id=\"type\" v-model=\"fk_type\"-->\n                    <select v-model=\"fk_type\" class=\"form-control\" v-on:change=\"onChangeSelect($event)\">\n                        <option v-for=\"(item, indx) in type.results\" :key=\"indx\" :value=\"item.id\">{{ item.type_equipment }} (id = {{ item.id }})</option>\n                    </select>\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"serial_number\">Серийный номер</label>\n                    <input type=\"text\" class=\"form-control\" id=\"serial_number\" v-model=\"serial_number\">\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"text\">Примечание</label>\n                    <textarea class=\"form-control\" id=\"text\" v-model=\"text\"></textarea>\n                </div>\n                <div class=\"form-group\">\n                    <button class=\"btn btn-outline-success w-100 my-3\" type=\"submit\">Добавить</button>\n                </div>\n            </form>\n        </div>\n        <div class=\"equipment_content\">\n            <h1 class=\"mt-4\">Список оборудования</h1>\n            <ul class=\"equipment_list\">\n                <li v-for=\"item in data.results\" :key=\"item.id\">\n                    <h3>Тип оборудования: {{ item.fk_type }}</h3>\n                    <!--div class=\"form-group\">\n                        <label for=\"fk_type\">Тип оборудования</label>\n                        <input type=\"text\" class=\"form-control\" id=\"fk_type\" :value=\"item.fk_type\" @input=\"item.fk_type = $event.target.value\">\n                    </div-->\n                    <!--p>Серийный номер: {{ item.serial_number }}</p-->\n                    <div class=\"form-group col-4 mx-auto\">\n                        <label for=\"serial_number\">Серийный номер</label>\n                        <input type=\"text\" class=\"form-control\" id=\"serial_number\" :value=\"item.serial_number\" @input=\"item.serial_number = $event.target.value\">\n                    </div>\n                    <!--p>Примечание: {{ item.text }}</p-->\n                    <div class=\"form-group col-4 mx-auto\">\n                        <label for=\"text\">Примечание</label>\n                        <textarea class=\"form-control\" id=\"text\" :value=\"item.text\" @input=\"item.text = $event.target.value\" ></textarea>\n                    </div>\n                    <button class=\"btn btn-success mx-2 my-3\" @click=\"toggleEquipment(item)\">Редактировать</button>\n                    <button class=\"btn btn-danger mx-2 my-3\" @click=\"deleteEquipment(item)\">Удалить</button>\n                </li>\n            </ul>\n        </div>\n    </div>\n</template>\n\n<script>\n    import axios from 'axios';\n    //import { ref } from 'vue';\n    export default {\n        data() {\n            return {\n                data: [],\n                type: [],\n                fk_type: '',\n                serial_number: '',\n                text: ''\n            }\n        },\n        methods: {\n            onChangeSelect: function(e) {\n                var fk_id = e.target.value;\n                console.log('id = ', fk_id);\n                if (fk_id == '1') {\n                    var regex = new RegExp(/[0-9A-Z]{2}[A-Z]{5}[A-Z0-9]{1}[A-Z]{2}/);\n                }else if (fk_id == '2') {\n                    regex = new RegExp(/[0-9]{1}[A-Z0-9]{2}[A-Z]{2}[0-9A-Z]{1}[-,_,@]{1}[0-9A-Z]{1}[a-z]{2}/);\n                }else if (fk_id == '3') {\n                    regex = new RegExp(/[0-9]{1}[A-Z]{4}[0-9A-Z]{1}[-,_,@]{1}[0-9A-Z]{3}/);\n                }\n                console.log('regex = ',  regex);\n            },\n            async getData() {\n                try {\n                    const response = await axios.get('http://127.0.0.1:9000/equipment/');\n                    this.data = response.data;\n                } catch (error) {\n                    // log the error\n                    console.log(error);\n                }\n            },\n            async getType() {\n                try {\n                    const response = await axios.get('http://127.0.0.1:9000/equipment-type/');\n                    this.type = response.data;\n                } catch (error) {\n                    // log the error\n                    console.log(error);\n                }\n            },\n            async submitForm(){\n                var ser = document.getElementById('serial_number').value;\n                console.log('ser_num = ', ser);\n                console.log('this.regex = ', this.regex);\n                if (this.regex.test(ser) == true) {\n                    try {\n                        // Send a POST request to the API\n                        await axios.post('http://localhost:9000/equipment/', {\n                            fk_type: this.fk_type,\n                            serial_number: this.serial_number,\n                            text: this.text,\n                            completed: false\n                        });\n                        console.log('this.fk_type = ', this.fk_type);\n                        //this.data.push(response.data);\n                        this.getData();\n                        this.fk_type = '';\n                        this.serial_number = '';\n                        this.text = '';\n                    } catch (error) {\n                        // Log the error\n                        console.log(error);\n                    }\n                }else {\n                    document.getElementById('serial_number').after('Ошибка введения серийного номера для данного типа оборудования');\n                    return false;\n                }\n\n            },\n            async deleteEquipment(item){\n                let confirmation = confirm(\"Вы действительно хотите удалить оборудование?\");\n                if(confirmation){\n                    try{\n                        // Send a request to delete the item\n                        await axios.delete(`http://localhost:9000/equipment/${item.id}`);\n                        // Refresh the equipment list\n                        this.getData();\n                    }catch(error){\n                        console.log(error)\n                    }\n                }\n            },\n            async toggleEquipment(item){\n                try{\n\n                    // Send a request to API to update the equipment\n                    const response = await axios.put(`http://localhost:9000/equipment/${item.id}/`, {\n                        //completed: false,\n                        fk_type: item.fk_type,\n                        serial_number: item.serial_number,\n                        text: item.text\n                    });\n                    console.log('response.data = ', response.data);\n                }catch(error){\n                    // Log any error\n                    console.log(error);\n                }\n            }\n        },\n        created() {\n            this.getData();\n            this.getType();\n        }\n    }\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}